<div class="container-fluid">

    <!-- start page title -->
    <div class="row">
        <div class="col-12">
            <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                <h4 class="mb-sm-0">Request </h4>

                <div class="page-title-right">
                    <ol class="breadcrumb m-0">
                        <li class="breadcrumb-item">
                            <ts href="javascript: void(0);">Requests </ts>
                        </li>
                        <li class="breadcrumb-item active">Index<i class="mdi mdi-alpha-x-circle:"></i></li>
                    </ol>
                </div>

            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-xxl-12">
                <div class="card">
                    <div class="card-body">
                        <!-- Nav tabs -->
                        <ul class="nav nav-pills animation-nav nav-justified gap-2 mb-3" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link waves-effect waves-light active typeofsystem fw-bold"
                                    data-bs-toggle="tab" id="current" role="tab">
                                    CURRENT SYSTEM | MODULE
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link waves-effect waves-light typeofsystem fw-bold" data-bs-toggle="tab"
                                    id="new" role="tab">
                                    NEW SYSTEM | MODULE
                                </a>
                            </li>
                        </ul>
                        <hr>
                        <div class="tab-content">
                            <div class="tab-pane active" id="current" role="tabpanel">
                                <div class="d-flex">
                                    <div class="col-xl-12">
                                        <div class="card-body">
                                            <ul class="nav nav-pills arrow-navtabs nav-secondary bg-light mb-4"
                                                role="tablist">
                                                <li class="nav-item">
                                                    <a id="ISR" aria-expanded="false" class="nav-link active type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">ISR</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="ATTENDANCE" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">ATTENDANCE</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="MINUTES" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">MINUTES</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="WALKTHROUGH" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">WALKTHROUGH</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="FLOWCHART" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">FLOWCHART</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="DFD" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">DFD</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="GANTT_CHART" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">GANTT CHART</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="SYSTEM_PROPOSED" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">SYSTEM PROPOSED</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="LOCAL_TESTING" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:siderbar-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">LOCAL TESTING</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="UAT" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">UAT</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="LIVE_TESTING" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">LIVE TESTING</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="USER_GUIDE" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">USER GUIDE</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="MEMO" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">MEMO</span>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a id="BUSINESS_ACCEPTANCE" aria-expanded="true" class="nav-link type"
                                                        data-bs-toggle="tab">
                                                        <span class="d-block d-sm-none"><iconify-icon
                                                                icon="solar:code-file-bold-duotone"
                                                                class="fs-25"></iconify-icon></span>
                                                        <span class="d-none d-sm-block">BUSINESS ACCEPTANCE</span>
                                                    </a>
                                                </li>
                                            </ul>
                                            <hr>
                                            <div class="tab-content">
                                                <div class="mt-2 tab-pane active" id="current" role="tabpanel">
                                                    <div class="table-responsive">
                                                        <table class="table table-striped table-hover" id="typeofsystem_table">
                                                            <thead class="table-primary text-center">
                                                                <tr>
                                                                    <th>FILENAME</th>
                                                                    <th>UPLOADED TO</th>
                                                                    <th>STATUS</th>
                                                                    <th>ACTION</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var typeofsystem = "current";
    var type = "ISR";
    var table;
    $('#SYSTEM_PROPOSED').closest('li').hide();
    $('#GANTT_CHART').closest('li').show();
    
    load_system_content(typeofsystem, type);

    $("a.typeofsystem").click(function () {
        $("a.typeofsystem").removeClass('btn-primary');
        $(this).addClass('btn-primary');
        typeofsystem = this.id;

        if (typeofsystem == 'new') {
            $('#SYSTEM_PROPOSED').closest('li').show();
            $('#GANTT_CHART').closest('li').hide();
            $('#USER_GUIDE').closest('li').hide();
            $('#MEMO').closest('li').hide();
            $('#BUSINESS_ACCEPTANCE').closest('li').hide();
        }
         
        if (typeofsystem == 'current') {
            $('#SYSTEM_PROPOSED').closest('li').hide();
            $('#GANTT_CHART').closest('li').show();
            $('#USER_GUIDE').closest('li').show();
            $('#MEMO').closest('li').show();
            $('#BUSINESS_ACCEPTANCE').closest('li').show();
        }

        load_system_content(typeofsystem, type);
    });

    $("a.type").click(function () {
        $("a.type").removeClass('btn-primary');
        $(this).addClass('btn-primary');
        type = this.id;
        load_system_content(typeofsystem, type);
    });

    function load_system_content(typeofsystem, type) {
        table = $('#typeofsystem_table').DataTable({
            processing: true,
            serverSide: true,
            stateSave: true,
            destroy: true,
            ajax: {
                url: '<?php echo base_url('typeofsystem_data'); ?>',
                type: 'POST',
                data: {
                    type: type,
                    system: typeofsystem
                }
            },
            columns: [
                { data: 'file_name' },
                { data: 'uploaded_to' },
                { data: 'status' },
                { data: 'action' }
            ],
            paging: true,
            searching: true,
            ordering: true,
            columnDefs: [
                { "className": "text-center", "targets": ['_all'] }
            ],
        });
    }
    function approved(fileId, type, typeofsystem) {
    Swal.fire({
        title: 'Are you sure?',
        text: 'You want to approve this file?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: 'Yes, approve it!',
        cancelButtonText: 'No, cancel!',
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: '<?php echo base_url('approved'); ?>',
                    type: 'POST',
                    data: {
                        file_id: fileId,
                        type: type,
                        typeofsystem: typeofsystem
                    },
                    success: function () {
                        Swal.fire({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 1500,
                            timerProgressBar: true,
                            icon: 'success',
                            title: 'Successfully Approved!',
                        });
                        $('#typeofsystem_table').DataTable().ajax.reload();
                    },
                });
            }
        });
    }

</script>